<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Calculateur TVA PRO</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
    font-family: Arial, sans-serif;
    background: linear-gradient(135deg,#1e88e5,#1565c0);
    min-height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
}
.card{
    background:#fff;
    padding:25px;
    border-radius:16px;
    width:100%;
    max-width:450px;
    box-shadow:0 20px 40px rgba(0,0,0,.25);
}
h1{text-align:center;margin-bottom:15px}
input,select,button{
    width:100%;
    padding:12px;
    margin-top:10px;
    font-size:16px;
    border-radius:10px;
    border:1px solid #ccc;
}
.tva-buttons{
    display:flex;
    gap:10px;
}
.tva-buttons button{
    flex:1;
    background:#eee;
    color:#333;
}
.tva-buttons button.active{
    background:#1e88e5;
    color:white;
}
.result{
    margin-top:15px;
    background:#e3f2fd;
    padding:15px;
    border-radius:12px;
    text-align:center;
}
.history{
    margin-top:15px;
    font-size:14px;
}
.history div{
    background:#f5f5f5;
    padding:8px;
    margin-top:5px;
    border-radius:6px;
}
.mode{
    display:flex;
    gap:10px;
}
.mode button{
    flex:1;
    background:#eee;
}
.mode button.active{
    background:#43a047;
    color:white;
}
.add{
    background:#43a047;
    color:white;
}
.total{
    margin-top:10px;
    background:#c8e6c9;
    padding:10px;
    border-radius:10px;
}
</style>
</head>

<body>

<div class="card">
<h1>ðŸ§¾ Calculateur TVA PRO</h1>

<input id="price" type="number" step="0.01" placeholder="Prix" oninput="calculate()">

<div class="mode">
    <button onclick="setMode('ht')" id="htBtn" class="active">HT</button>
    <button onclick="setMode('ttc')" id="ttcBtn">TTC</button>
</div>

<div class="tva-buttons">
    <button onclick="setTVA(0.055)" class="active">5,5%</button>
    <button onclick="setTVA(0.10)">10%</button>
    <button onclick="setTVA(0.20)">20%</button>
</div>

<div class="result" id="result">Entre un prix</div>

<button class="add" onclick="addToCaisse()">âž• Ajouter Ã  la caisse</button>

<div class="total" id="total">Total caisse : 0.00 â‚¬</div>

<div class="history">
<strong>Historique :</strong>
<div id="history"></div>
</div>
</div>

<script>
let tva=0.055;
let mode="ht";
let caisse=[];
let total=0;

function setTVA(value){
    tva=value;
    document.querySelectorAll(".tva-buttons button").forEach(b=>b.classList.remove("active"));
    event.target.classList.add("active");
    calculate();
}

function setMode(value){
    mode=value;
    document.getElementById("htBtn").classList.remove("active");
    document.getElementById("ttcBtn").classList.remove("active");
    document.getElementById(value+"Btn").classList.add("active");
    calculate();
}

function calculate(){
    const price=parseFloat(document.getElementById("price").value);
    const result=document.getElementById("result");

    if(isNaN(price)||price<=0){
        result.innerHTML="âŒ Prix invalide";
        return;
    }

    let ht,ttc,tvaAmount;

    if(mode==="ht"){
        ht=price;
        tvaAmount=ht*tva;
        ttc=ht+tvaAmount;
    }else{
        ttc=price;
        ht=ttc/(1+tva);
        tvaAmount=ttc-ht;
    }

    result.innerHTML=`
    HT : <strong>${ht.toFixed(2)} â‚¬</strong><br>
    TVA (${(tva*100).toFixed(1)}%) : <strong>${tvaAmount.toFixed(2)} â‚¬</strong><br>
    TTC : <strong>${ttc.toFixed(2)} â‚¬</strong>
    `;

    saveHistory(ht,ttc);
}

function saveHistory(ht,ttc){
    const history=document.getElementById("history");
    const line=document.createElement("div");
    line.textContent=`HT ${ht.toFixed(2)} â‚¬ â†’ TTC ${ttc.toFixed(2)} â‚¬`;
    history.prepend(line);
    if(history.children.length>8){
        history.removeChild(history.lastChild);
    }
}

function addToCaisse(){
    const price=parseFloat(document.getElementById("price").value);
    if(isNaN(price)||price<=0)return;

    let ttc = mode==="ht" ? price*(1+tva) : price;
    caisse.push(ttc);
    total=caisse.reduce((a,b)=>a+b,0);
    document.getElementById("total").innerHTML=`ðŸ’° Total caisse : <strong>${total.toFixed(2)} â‚¬</strong>`;
}
</script>

</body>
</html>
